<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd">

    <changeSet id="create-aspect-logs-indexes" author="Y_Lab_student">
        <createIndex tableName="aspect_logs" schemaName="entity" indexName="idx_aspect_logs_created_at">
            <column name="created_at" descending="true"/>
        </createIndex>
        <createIndex tableName="aspect_logs" schemaName="entity" indexName="idx_aspect_logs_user">
            <column name="user_id"/>
        </createIndex>
        <createIndex tableName="aspect_logs" schemaName="entity" indexName="idx_aspect_logs_method">
            <column name="method_name"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-performance-metrics-indexes" author="Y_Lab_student">
        <createIndex tableName="performance_metrics" schemaName="entity" indexName="idx_perf_metrics_service">
            <column name="service_name"/>
        </createIndex>
        <createIndex tableName="performance_metrics" schemaName="entity" indexName="idx_perf_metrics_updated">
            <column name="updated_at" descending="true"/>
        </createIndex>
        <createIndex tableName="performance_metrics" schemaName="entity" indexName="idx_perf_metrics_avg_time">
            <column name="avg_execution_time" descending="true"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-cache-data-indexes" author="Y_Lab_student">
        <createIndex tableName="cache_data" schemaName="entity" indexName="idx_cache_data_type">
            <column name="cache_type"/>
        </createIndex>
        <createIndex tableName="cache_data" schemaName="entity" indexName="idx_cache_data_expiration">
            <column name="expiration_time"/>
        </createIndex>
        <createIndex tableName="cache_data" schemaName="entity" indexName="idx_cache_data_last_accessed">
            <column name="last_accessed" descending="true"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-user-aop-indexes" author="Y_Lab_student">
        <createIndex tableName="users" schemaName="entity" indexName="idx_users_is_active">
            <column name="is_active"/>
        </createIndex>
        <createIndex tableName="users" schemaName="entity" indexName="idx_users_last_login">
            <column name="last_login_at" descending="true"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-product-aop-indexes" author="Y_Lab_student">
        <createIndex tableName="products" schemaName="entity" indexName="idx_products_last_updated_by">
            <column name="last_updated_by"/>
        </createIndex>
        <createIndex tableName="products" schemaName="entity" indexName="idx_products_is_cached">
            <column name="is_cached"/>
        </createIndex>
        <createIndex tableName="products" schemaName="entity" indexName="idx_products_view_count">
            <column name="view_count" descending="true"/>
        </createIndex>
    </changeSet>

    <changeSet id="create-composite-performance-index" author="Y_Lab_student">
        <createIndex tableName="aspect_logs" schemaName="entity"
                     indexName="idx_aspect_logs_performance">
            <column name="aspect_type"/>
            <column name="status"/>
            <column name="execution_time" descending="true"/>
        </createIndex>
    </changeSet>
</databaseChangeLog>